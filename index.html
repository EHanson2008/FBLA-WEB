<!-- index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AP Learning Hub</title>
  <link rel="stylesheet" href="style.css">

  <!-- Firebase (compat versions) -->
  <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore-compat.js"></script>

  <style>
    /* Login box styling (only affects the login section) */
    #login .box{
      width:min(380px, 92vw);
      background:#fff;
      padding:20px;
      border-radius:16px;
      box-shadow:0 2px 12px rgba(0,0,0,.10);
      margin-top: 16px;
    }
    #login label{ display:block; margin-top:10px; font-size:13px; color:#333; }
    #login input{
      width:100%;
      padding:10px 12px;
      margin-top:6px;
      border-radius:10px;
      border:1px solid #ccc;
      outline:none;
      box-sizing: border-box;
    }
    #login .row{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
      margin-top:12px;
    }
    #login button{
      width:100%;
      padding:10px 12px;
      border-radius:10px;
      border:none;
      cursor:pointer;
    }
    #login .ghost{ background:#eef0f6; }
    #login .msg{
      margin:10px 0 0;
      min-height:18px;
      font-size:13px;
      color:#b00020;
    }
    #login .ok{ color:#0a7a0a; }
    #login .tiny{
      margin-top:12px;
      font-size:12px;
      color:#666;
      line-height:1.35;
    }
  </style>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyAKOefCF82WvxZ-hCQ_I5PcyLJ8tJ3hexI",
      authDomain: "ap-learning-hub.firebaseapp.com",
      projectId: "ap-learning-hub",
      storageBucket: "ap-learning-hub.firebasestorage.app",
      messagingSenderId: "549215735037",
      appId: "1:549215735037:web:1d1485b21717e9c95ec294",
      measurementId: "G-NDS7D1PQDF"
    };
  </script>
</head>

<body>
  <header class="topbar">
    <h1 class="logo">AP Learning Hub</h1>
    <nav class="nav">
      <button class="tab" data-target="home">Home</button>
      <button class="tab" data-target="schedule">Schedule</button>
      <button class="tab" data-target="dashboard">Dashboard</button>
      <button class="tab" data-target="resources">Resources</button>
      <button class="tab" data-target="login">Login</button>
    </nav>
    <div class="spacer"></div>
  </header>

  <main>
    <section id="home">
      <div class="hero">
        <h1>AP Learning Hub</h1>
        <p>Your all-in-one dashboard for studying smarter: schedule sessions, track tasks, and keep resources in one place.</p>
        <div class="row" style="margin-top:12px;">
          <button class="btn primary tab" data-target="dashboard" type="button">Go to Dashboard</button>
          <button class="btn ghost tab" data-target="schedule" type="button">Plan Study Schedule</button>
          <span class="pill" id="userPill">Not logged in</span>
        </div>
      </div>

      <div class="grid cols-3" style="margin-top:14px;">
        <div class="card">
          <h2>Today’s Focus</h2>
          <p class="small" id="todayFocus">Add tasks in the Dashboard to see them here.</p>
        </div>
        <div class="card">
          <h2>Upcoming Session</h2>
          <p class="small" id="upcomingSession">Add a session in Schedule.</p>
        </div>
        <div class="card">
          <h2>Progress</h2>
          <div class="progress"><div id="progressBar"></div></div>
          <p class="small" id="progressText" style="margin-top:8px;">0% complete</p>
        </div>
      </div>
    </section>

    <section id="schedule">
      <h1>Study schedule</h1>
      <p>Add study sessions (shared when you're in a hub).</p>

      <!-- ✅ Shared hub controls -->
      <div class="card" style="margin-bottom:14px;">
        <h2>Shared Schedule Hub</h2>
        <p class="small">Create a hub (share the code) or join a hub to sync schedules across accounts.</p>
        <div class="row" style="margin-top:10px;">
          <button class="btn primary" id="createHubBtn" type="button">Create hub</button>
          <input id="hubCode" placeholder="Enter hub code" style="max-width:260px;">
          <button class="btn ghost" id="joinHubBtn" type="button">Join hub</button>
          <button class="btn ghost" id="leaveHubBtn" type="button">Leave hub</button>
          <span class="pill" id="hubStatus">No hub selected</span>
        </div>
        <p class="small" style="margin-top:8px;">
          Not in a hub? Your schedule saves locally. In a hub? Your schedule is shared live.
        </p>
      </div>

      <div class="grid cols-2">
        <div class="card">
          <h2>Add a session</h2>
          <label class="small">Title</label>
          <input id="sessTitle" placeholder="AP Calc AB - FRQ practice" />

          <div class="row" style="margin-top:10px;">
            <div style="flex:1; min-width:220px;">
              <label class="small">Date</label>
              <input id="sessDate" type="date" />
            </div>
            <div style="flex:1; min-width:220px;">
              <label class="small">Time</label>
              <input id="sessTime" type="time" />
            </div>
          </div>

          <label class="small" style="margin-top:10px;">Notes</label>
          <textarea id="sessNotes" rows="3" placeholder="What are you doing? What to bring?"></textarea>

          <div class="row" style="margin-top:10px;">
            <button class="btn primary" id="addSessionBtn" type="button">Add session</button>
            <button class="btn ghost" id="clearSessionsBtn" type="button">Clear all</button>
          </div>
          <p class="msg" id="scheduleMsg"></p>
        </div>

        <div class="card">
          <h2>Upcoming</h2>
          <div class="list" id="sessionList"></div>
          <p class="small" id="sessionEmpty">No sessions yet.</p>

          <hr style="border:none; border-top:1px solid var(--border); margin:14px 0;">

          <!-- ✅ Live Sessions -->
          <h2>Live study sessions</h2>
          <p class="small">Start a live session from a scheduled session, or join one below.</p>
          <div class="list" id="liveList"></div>
          <p class="small" id="liveEmpty">No live sessions right now.</p>

          <hr style="border:none; border-top:1px solid var(--border); margin:14px 0;">

          <!-- ✅ Shared Chat -->
          <h2>Live Chat</h2>
          <p class="small">Chat is shared inside your hub (works best during live sessions).</p>
          <div class="card" style="margin-top:10px;">
            <div class="row">
              <input id="chatText" placeholder="Type a message..." style="flex:1; min-width:220px;">
              <button class="btn primary" id="sendChatBtn" type="button">Send</button>
            </div>
            <div class="list" id="chatList" style="margin-top:12px; max-height:240px; overflow:auto;"></div>
            <p class="small" id="chatEmpty">No messages yet.</p>
          </div>

          <hr style="border:none; border-top:1px solid var(--border); margin:14px 0;">

          <!-- ✅ Shared Notes -->
          <h2>Shared Notes</h2>
          <p class="small">Everyone in your hub can edit these notes live.</p>
          <div class="card" style="margin-top:10px;">
            <textarea id="sharedNotes" rows="8" placeholder="Write shared notes here..."></textarea>
            <div class="row" style="margin-top:10px;">
              <button class="btn primary" id="saveNotesBtn" type="button">Save notes</button>
              <span class="pill" id="notesStatus">Not saved</span>
            </div>
          </div>

        </div>
      </div>
    </section>

    <section id="dashboard">
      <h1>Dashboard</h1>
      <p>To-do list + progress tracking.</p>

      <div class="grid cols-2">
        <div class="card">
          <h2>Add a task</h2>
          <label class="small">Task</label>
          <input id="taskText" placeholder="Finish AP Physics circuits practice set" />

          <div class="row" style="margin-top:10px;">
            <div style="flex:1; min-width:220px;">
              <label class="small">Class</label>
              <select id="taskClass"></select>
            </div>
            <div style="flex:1; min-width:220px;">
              <label class="small">Due (optional)</label>
              <input id="taskDue" type="date" />
            </div>
          </div>

          <div class="row" style="margin-top:10px;">
            <button class="btn primary" id="addTaskBtn" type="button">Add task</button>
            <button class="btn ghost" id="clearTasksBtn" type="button">Clear all</button>
            <span class="pill" id="streakPill">Streak: 0</span>
          </div>

          <p class="msg" id="dashMsg"></p>
        </div>

        <div class="card">
          <h2>Your tasks</h2>
          <div class="list" id="taskList"></div>
          <p class="small" id="taskEmpty">No tasks yet.</p>

          <div style="margin-top:12px;">
            <div class="progress"><div id="taskProgress"></div></div>
            <p class="small" id="taskProgressText" style="margin-top:8px;">0 / 0 done</p>
          </div>
        </div>
      </div>

      <div class="grid cols-2" style="margin-top:14px;">
        <div class="card">
          <h2>Weekly Study Minutes</h2>
          <p class="small">Track minutes you study each day.</p>

          <div class="row">
            <input id="studyMinutes" type="number" min="0" placeholder="Minutes (ex: 45)" style="max-width:220px;">
            <button class="btn primary" id="addStudyBtn" type="button">Add</button>
            <button class="btn ghost" id="clearStudyBtn" type="button">Clear</button>
          </div>

          <canvas id="studyChart" width="520" height="220" style="margin-top:10px; width:100%;"></canvas>
          <p class="small" id="studyTotalText" style="margin-top:8px;">Total this week: 0</p>
        </div>

        <div class="card">
          <h2>Tasks Completed (Last 7 Days)</h2>
          <p class="small">Auto-updates when you mark tasks done.</p>
          <canvas id="tasksChart" width="520" height="220" style="margin-top:10px; width:100%;"></canvas>
        </div>
      </div>

      <div class="card" style="margin-top:14px;">
        <h2>Grades Tracker</h2>
        <p class="small">Set category weights, then add assignments. It calculates your current grade.</p>

        <div class="grid cols-3" style="margin-top:10px;">
          <div>
            <label class="small">Class</label>
            <select id="gradeClass"></select>
          </div>

          <div>
            <label class="small">Summative weight (%)</label>
            <input id="wSumm" type="number" min="0" max="100" placeholder="90">
          </div>

          <div>
            <label class="small">Formative weight (%)</label>
            <input id="wForm" type="number" min="0" max="100" placeholder="10">
          </div>
        </div>

        <div class="row" style="margin-top:10px;">
          <button class="btn primary" id="saveWeightsBtn" type="button">Save weights</button>
          <span class="pill" id="weightsStatus">Weights not set</span>
        </div>

        <hr style="border:none; border-top:1px solid var(--border); margin:14px 0;">

        <div class="grid cols-2">
          <div>
            <h3 style="margin:0 0 8px; font-size:16px;">Add assignment</h3>
            <label class="small">Name</label>
            <input id="aName" placeholder="Unit 6 Test" />

            <div class="row" style="margin-top:10px;">
              <div style="flex:1; min-width:180px;">
                <label class="small">Category</label>
                <select id="aCat">
                  <option value="summ">Summative</option>
                  <option value="form">Formative</option>
                </select>
              </div>
              <div style="flex:1; min-width:180px;">
                <label class="small">Score (%)</label>
                <input id="aScore" type="number" min="0" max="100" placeholder="85">
              </div>
            </div>

            <div class="row" style="margin-top:10px;">
              <button class="btn primary" id="addAssignBtn" type="button">Add</button>
              <button class="btn ghost" id="clearAssignBtn" type="button">Clear class</button>
              <span class="pill" id="currentGradePill">Current: --</span>
            </div>

            <div class="row" style="margin-top:10px;">
              <input id="targetGrade" type="number" min="0" max="100" placeholder="Target grade (ex: 90)" style="max-width:220px;">
              <button class="btn ghost" id="needNextBtn" type="button">What do I need next?</button>
              <span class="small" id="needNextText"></span>
            </div>

            <p class="msg" id="gradeMsg"></p>
          </div>

          <div>
            <h3 style="margin:0 0 8px; font-size:16px;">Assignments</h3>
            <div class="list" id="assignList"></div>
            <p class="small" id="assignEmpty">No assignments yet.</p>
          </div>
        </div>
      </div>

    </section>

    <section id="resources">
      <h1>Resources</h1>
      <p>Search your favorite links by class.</p>

      <div class="card">
        <div class="row">
          <input id="resSearch" placeholder="Search (ex: derivatives, circuits, rates...)" style="flex:1; min-width:240px;" />
          <select id="resFilter" style="width:220px;"></select>
        </div>

        <div class="list" id="resList" style="margin-top:12px;"></div>
        <p class="small" id="resEmpty">No matches.</p>
      </div>
    </section>

    <section id="login">
      <h1>Login</h1>
      <p>Sign up or log in with email + password.</p>

      <div class="box">
        <label for="email">Email</label>
        <input id="email" type="email" placeholder="you@example.com" autocomplete="username" />

        <label for="password">Password</label>
        <input id="password" type="password" placeholder="••••••••" autocomplete="current-password" />

        <button id="googleBtn" class="ghost" type="button" style="margin-top:10px;">
          Sign in with Google
        </button>

        <div class="row">
          <button id="signupBtn" class="ghost" type="button">Sign up</button>
          <button id="loginBtn" type="button">Log in</button>
        </div>

        <button id="resetBtn" class="ghost" type="button" style="margin-top:10px;">
          Forgot password
        </button>

        <button id="logoutBtn" class="ghost" type="button" style="margin-top:10px; display:none;">
          Logout
        </button>

        <p id="msg" class="msg"></p>
        <p class="tiny" id="status"></p>
      </div>
    </section>
  </main>

  <script src="app.js"></script>
</body>
</html>
